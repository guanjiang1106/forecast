# 预测性维护系统

## 系统概述
本系统是一个基于Python的预测性维护工具，支持设备运行数据的随机生成、寿命预测以及可视化展示。系统采用现代化的界面设计，提供直观的数据展示和分析结果。

## 功能特点
- 随机数据生成
- 设备寿命预测
- 实时状态监控
- 可视化数据展示
- 维护建议提供

## 数据基本要求

### 数据字段说明
1. 时间戳
   - 格式：datetime
   - 范围：从2025年3月7日开始，向前推算1000小时
   - 分布：均匀分布，每条记录间隔1小时

2. 温度
   - 单位：°C
   - 范围：20-80°C
   - 分布：正态分布（均值50°C，标准差10°C）

3. 振动
   - 单位：mm/s
   - 范围：0.1-5.0 mm/s
   - 分布：正态分布（均值2.0 mm/s，标准差0.5 mm/s）

4. 压力
   - 单位：kPa
   - 范围：50-150 kPa
   - 分布：正态分布（均值100 kPa，标准差20 kPa）

5. 运行小时数
   - 单位：小时
   - 范围：0-999
   - 分布：线性递增

## 核心逻辑说明

### 1. 数据生成逻辑
- 使用Python的numpy.random.normal生成符合正态分布的随机数据
- 对超出范围的数据进行截断处理，确保数据在有效范围内
- 数据生成后自动存入SQL Server数据库

### 2. 寿命预测算法
1. 基本参数
   - 设备理论寿命：10,000小时
   - 异常阈值：
     * 温度：60°C
     * 振动：3.0 mm/s
     * 压力：120 kPa

2. 计算步骤
   - 计算各参数异常值
   - 计算健康衰减因子（权重：温度0.3，振动0.4，压力0.3）
   - 计算剩余使用寿命（RUL）
   - 添加±5%随机噪声

3. 维护建议分级
   - RUL < 1000小时：需要立即维护
   - RUL < 3000小时：需要近期维护
   - RUL ≥ 3000小时：继续监测

## 环境要求

### 依赖包
```
streamlit==1.32.0
pyodbc==5.0.1
pandas==2.2.1
numpy==1.26.4
plotly==5.19.0
python-dotenv==1.0.1
```

### 数据库配置
需要在项目根目录创建.env文件，包含以下配置：
```
DB_SERVER=your_server_name
DB_NAME=your_database_name
DB_USERNAME=your_username
DB_PASSWORD=your_password
```

## 使用说明

1. 安装依赖
```bash
pip install -r requirements.txt
```

2. 配置数据库
- 创建.env文件
- 填入数据库连接信息

3. 启动应用
```bash
streamlit run app.py
```

4. 使用流程
- 点击"生成随机数据"按钮生成模拟数据
- 点击"开始预测"按钮查看预测结果
- 查看数据趋势图和RUL趋势图
- 根据维护建议采取相应措施

## 界面说明

### 主要组件
1. 操作区
   - 生成随机数据按钮
   - 开始预测按钮

2. 数据展示区（左侧）
   - 数据表格显示

3. 结果展示区（右侧）
   - 当前设备状态
   - 预测结果
   - 异常值分析
   - 参数趋势图
   - RUL趋势图

### 可视化特点
- 使用plotly实现交互式图表
- 多参数趋势图使用不同颜色区分
- 显示关键阈值线
- 标记当前状态点